From: Robert Luberda <robert@debian.org>
Date: Sun, 6 Oct 2013 13:30:19 +0200
Subject: Fix a crash occurring when $HOME is not defined

Bugs-Debian: https://bugs.debian.org/716468
---
 src/wmnd.c | 13 ++++++++-----
 1 file changed, 8 insertions(+), 5 deletions(-)

diff --git a/src/wmnd.c b/src/wmnd.c
index 7fca15d..7dc9aba 100644
--- a/src/wmnd.c
+++ b/src/wmnd.c
@@ -861,12 +861,15 @@ int main(int argc, char* *argv)
     if(!conf_file)
     {
       char* tmp;
-      tmp = getenv("HOME");
-      conf_file = (char*)calloc(1, strlen(tmp) + 9);
-      strcat(conf_file, tmp);
-      strcat(conf_file, "/.wmndrc");
+      if ( ((tmp = getenv("HOME")))
+          && ((conf_file = (char*)calloc(1, strlen(tmp) + 9))) )
+      {
+        strcat(conf_file, tmp);
+        strcat(conf_file, "/.wmndrc");
+      }
     }
-    conf_read(conf_file);
+    if(conf_file)
+      conf_read(conf_file);
   }
 
   /* set stuff here */
